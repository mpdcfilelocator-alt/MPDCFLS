<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MPDC File Locator</title>

    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Popup Logo Animation Styles */
        .logo-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
            animation: overlayFadeIn 0.5s ease-in-out forwards;
        }

        .logo-popup-container {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .logo-popup-image {
            max-width: 300px;
            max-height: 300px;
            animation: logoZoomIn 0.8s ease-in-out forwards;
        }

        @keyframes overlayFadeIn {
            from {
                opacity: 0;
                backdrop-filter: blur(0px);
            }
            to {
                opacity: 1;
                backdrop-filter: blur(5px);
            }
        }

        @keyframes logoZoomIn {
            from {
                opacity: 0;
                transform: scale(0.5);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes popupFadeOut {
            from {
                opacity: 1;
                backdrop-filter: blur(5px);
            }
            to {
                opacity: 0;
                backdrop-filter: blur(0px);
            }
        }

        body.popup-active {
            overflow: hidden;
        }

        /* Date input & Sort control styles */


        /* Date input & Sort control styles */
        .date-input-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .date-input-wrapper input[type="text"] {
            flex: 1;
        }
        .sort-control {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 8px;
        }
        .sort-select {
            display: none;
            padding: 6px;
            border-radius: 6px;
            border: 1px solid #ccc;
            background: white;
        }
        .header-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        @media (max-width: 600px) {
            .header-controls {
                flex-direction: column;
                align-items: stretch;
            }
            .sort-control {
                margin-left: 0;
            }
        }

        /* Image Upload Preview Styles */
        .file-image-thumbnail {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin: 10px 0;
        }

        .file-image-thumbnail:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .image-viewer-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .image-viewer-content img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            border-radius: 8px;
        }

        /* Workers box and reminder visibility - only show on hero/home */
        .workers-box, .reminder {
            display: none;
        }
        .hero-section.active ~ .workers-box,
        .hero-section.active ~ .reminder {
            display: block;
        }
        /* Alternative: show when hero is active using adjacent/next sibling won't work, so use class on body or JS */
        body.on-hero .workers-box,
        body.on-hero .reminder {
            display: block;
        }
        body:not(.on-hero) .workers-box,
        body:not(.on-hero) .reminder {
            display: none;
        }

        /* Force the workers box and reminder to keep the light-style backgrounds and dark text in all modes */
        .workers-box {
            background: rgba(255,255,255,0.92) !important;
            border-color: #ddd !important;
            color: #111 !important;
        }
        .workers-box input,
        .workers-box button,
        .workers-box select,
        .workers-box textarea {
            background: #fff !important;
            color: #111 !important;
            border-color: #ccc !important;
        }
        .workers-box input::placeholder { color: #888 !important; }

        .reminder {
            background: rgba(255,250,200,0.95) !important;
            border-color: #f0e68c !important;
            color: #111 !important;
        }
    </style>
</head>
<body>


<div id="logoPopup" class="logo-popup-overlay" style="display: none;">
    <div class="logo-popup-container">
        <img class="logo-popup-image" src="https://raw.githubusercontent.com/MathEase07/FileLocator/main/MPDCC-removebg-preview.png" alt="MPDC Logo">
    </div>
</div>

  <!-- Workers list (top-left, not in navbar) -->
  <div class="workers-box" aria-label="Workers box" style="position: fixed; top: 100px; left: 12px; width: 260px; background:#f7f7f7; border:1px solid #ddd; border-radius:6px; padding:10px; box-shadow:0 2px 6px rgba(0,0,0,0.06); z-index:40;">
    <h4 style="margin:0 0 8px 0; font-size:14px;">Workers</h4>
    <div style="display:flex; gap:6px; margin-bottom:8px">
      <input id="workerNameInput" type="text" placeholder="Enter name" aria-label="Worker name" style="flex:1;padding:6px;border-radius:4px;border:1px solid #ccc;" />
      <button id="addWorkerBtn" style="padding:6px 8px;">Add</button>
    </div>
    <div style="font-size:12px;margin-bottom:8px">Selected: <span id="currentUserDisplay">None</span></div>
    <ul id="workersList" style="list-style:none;margin:0;padding:0;max-height:220px;overflow:auto;"></ul>
  </div>

  <!-- Reminder note (right side) -->
  <div class="reminder" aria-label="Reminder note" style="position: fixed; top: 100px; right: 12px; width: 300px; background#:f7f7f7; border:1px solid #ddd; padding:10px; border-radius:6px; box-shadow:0 2px 6px rgba(0,0,0,0.06); z-index:40;">
    <h4 style="margin:0 0 8px 0; font-size:14px;">Quick Reminders</h4>
    <ul style="padding-left:18px;margin:6px 0 0 0">
      <li>Keep files organized and updated.</li>
      <li>Always return borrowed files to their location.</li>
      <li>Update file info after changes.</li>
      <li>Label borrowed items clearly and promptly.</li>
    </ul>
  </div>

<header class="navbar">
    <div class="navbar-container">
        <div class="navbar-brand">
            <img src="https://raw.githubusercontent.com/MathEase07/MPDC-file-locator/main/rw.png" alt="Logo" style="height: 30px; width: auto; margin-right: 10px; object-fit: contain;">
            
         <font size="10">OMPDC File Locator </font>
        </div>
        <nav class="navbar-nav">
            <a href="#hero" class="nav-link" data-section="hero">Home</a>
            <a id="nav-features" href="#features" class="nav-link" data-section="features">Features</a>
            <a href="#instructions" class="nav-link" data-section="instructions">Instructions</a>
            <a href="#developers" class="nav-link" data-section="developers">Developers</a>
        </nav>
        <div class="navbar-controls">
            <button id="theme-toggle" class="theme-toggle" title="Toggle theme">
                <i class="fas fa-sun"></i>
            </button> 
            <button id="import-header-btn" class="btn btn-outline" onclick="importFiles()" title="Import files">
                <i class="fas fa-upload"></i> Import
            </button>
            <button id="signin-btn" class="btn btn-primary">Sign in</button>
            <button id="change-account-btn" class="btn btn-secondary" style="display:none;">Change Account</button>
            <button id="signout-header-btn" class="btn btn-secondary" style="display:none;">Sign out</button>
        </div>
    </div>
</header>


<section id="hero" class="view-section hero-section active" style="background-image: url('https://raw.githubusercontent.com/MathEase07/FileLocator/main/pu.jpg'); background-size: cover; background-position: center; background-attachment: fixed;">
    <div class="hero-background"></div>
    <div class="hero-content">
        <h3 class="hero-title">Office of Municipal Planning and Development Coordinator File Locator</h3>
        <p class="hero-subtitle">Search, Locate, and Retrieve your files efficiently.</p>
        <div class="search-container">
            <div class="search-wrapper">
                <i class="fas fa-search"></i>
                <input id="searchBar" class="search-box" placeholder="Search files..." />
            </div>
        </div>
        <div id="results" class="results-container"></div>
    </div>
</section>

<section id="features" class="view-section features-section">
    <div class="container">
        <h2 class="section-title">Features</h2>
       
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-search"></i>
                </div>
                <h3>Quick Search</h3>
                <p>Find your files in seconds with our powerful search engine.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <h3>Secure Storage</h3>
                <p>Your files are protected with enterprise-grade security.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-sync"></i>
                </div>
                <h3>Import & Export</h3>
                <p>Import or Export current data to share with others.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-share-alt"></i>
                </div>
                <h3>Easy Sharing</h3>
                <p>Share files with your team in one button.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <h3>Dynamic Search</h3>
                <p>Search any information you remember or want to find to see it.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h3>Mobile Ready</h3>
                <p>Access your files anytime, anywhere.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-plus"></i>
                </div>
                <h3>Easy Data Image Support Entry</h3>
                <p>Add files with detailed information, image, and all the data you need in just a few clicks.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h3>Borrow Return Tracking</h3>
                <p>Track borrowed and returned items with ease. Mark items as borrowed or returned directly from search results.</p>
            </div>
        </div>
    </div>
</section>


<div class="sidebar" style="display:none"></div>


<div class="main-content" style="display:none">
    <div class="header-top">
        <h2>All Files</h2>
        <div class="header-controls">
            <input type="text" class="search-box" id="searchBar-main" placeholder=" Search files...">
            <div class="sort-control">
                <button id="sort-toggle-btn" class="btn btn-outline" title="Sort options">
                    <i class="fas fa-sort"></i> Sort
                </button>
                <select id="sort-select" class="sort-select" aria-label="Sort results">
                    <option value="date-asc" selected>Chronological 路 OldestNewest</option>
                    <option value="date-desc">Chronological 路 NewestOldest</option>
                    <option value="month-year-asc">Group by Month (JanDec) 路 Year OldNew</option>
                    <option value="month-year-desc">Group by Month (JanDec) 路 Year NewOld</option>
                </select>
            </div>
        </div>
    </div>
    <div id="statusMessage"></div>
    <div id="results-main"></div>
</div>

<section id="instructions" class="view-section instructions-section">
    <div class="container">
        <h2 class="section-title">How to Use</h2>
        <div class="instructions-grid">
            <div class="instruction-card">
                <div class="step-number">1</div>
                <h3>Search & Find</h3>
                <p>Use the search feature to quickly locate your files.</p>
            </div>
            <div class="instruction-card">
                <div class="step-number">2</div>
                <h3>Sign In</h3>
                <p>Sign-in using "user" for Username and "password" for Password to change account and add data. </p>
            </div>
            <div class="instruction-card">
                <div class="step-number">3</div>
               <h3>Add Files</h3>
                <p>Enter file details including Date, Storage location, and Other informations, as well as images.</p> 
            </div>
            <div class="instruction-card">
                <div class="step-number">4</div>
                <h3>Export/Import</h3>
                <p>Backup your data or import files from other sources.</p>
            </div>
        </div>
    </div>
</section>

<section id="dashboard" class="view-section dashboard-section">
    <div class="container">
        <div class="dashboard-card">
            <h2>Add New File</h2>
            <div id="addForm" class="form-section active">
                <div id="addStatus"></div>

                <div class="form-group">
                    <label>Date</label>
                    <div class="date-input-wrapper">
                        <input type="text" id="title" placeholder="Enter file date..." data-date-picker />
                        <button type="button" id="open-date-picker" class="btn btn-outline" title="Open calendar">
                            <i class="fas fa-calendar"></i>
                        </button>
                        <input type="date" id="native-date-input" style="display:none" />
                    </div>
                </div>

                <div class="form-group">
                    <label>Storage Location</label>
                    <input type="text" id="storage" placeholder="Enter Location...">
                </div>

                <div class="form-group">
                    <label>Additional Information</label>
                    <textarea id="info" placeholder="Add details..."></textarea>
                </div>

                <div class="form-group">
                    <label>Upload Image (Optional)</label>
                    <input type="file" id="imageUpload" accept="image/*" placeholder="Choose an image...">
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="addFile()">
                        <i class="fas fa-plus"></i> Add File
                    </button>
                    <button class="btn btn-secondary" onclick="clearForm()">
                        <i class="fas fa-redo"></i> Clear
                    </button>
                </div>

                <div class="button-group">
                    <button class="btn btn-outline" onclick="exportFiles()">
                        <i class="fas fa-download"></i> Export Files
                    </button>
                  
                </div>
            </div>
        </div>
    </div>
</section>

<section id="developers" class="view-section developers-section">
    <div class="container">
        <h2 class="section-title">Our Team</h2>
        <div class="team-grid">
            <div class="team-member">
                <div class="member-avatar">RM</div>
                <h3>Renzo Miguel V. Masagnay</h3>
                <p class="member-role">Lead Developer</p>
            </div>
            <div class="team-member">
                <div class="member-avatar">BC</div>
                <h3>Bianca Cerrudo</h3>
                <p class="member-role">Lead Researcher</p>
            </div>
            <div class="team-member">
                <div class="member-avatar">AA</div>
                <h3>Ayessa Ayubo</h3>
                <p class="member-role">Team Member</p>
            </div>
            <div class="team-member">
                <div class="member-avatar">KV</div>
                <h3>Kinamiel Villamero</h3>
                <p class="member-role">Team Member</p>
            </div>
            <div class="team-member">
                <div class="member-avatar">DP</div>
                <h3>Dannise Peren</h3>
                <p class="member-role">Team Member</p>
            </div>
            <div class="team-member">
                <div class="member-avatar">AR</div>
                <h3>Aldhen Remojo</h3>
                <p class="member-role">Team Member</p>
            </div>
        </div>
    </div>
</section>

<footer class="footer">
    <div class="container">
        <div class="footer-content">
            <div class="footer-section">
                <h4>About</h4>
                <p>MPDC File Locator is a web-based platform designed to help users efficiently search, organize, and manage digital files.<br><br>
It provides a centralized system that allows quick and easy access to important documents.<br><br>
The platform features a user-friendly interface that improves productivity and reduces time spent searching for files.<br><br>
MPDC File Locator supports secure sign-in and file importing for better file organization and tracking.<br><br>
Overall, it helps streamline file management and improve digital workflow efficiency.</p>
            </div>
            <div class="footer-section" id="footer-quick-links">
                <h4>Contact</h4>
                <p><i class="fas fa-google"></i> mpdc.sariaya@gmail.com</p>

                 <p class="social-link"><i class="fab fa-facebook"></i> <a href="https://www.facebook.com/share/16knm4ssAt/" target="_blank">MPDC Lgu Sariaya</a></p>  
                 <p><i class="fas fa-phone"></i> 09632588981</p> 
            </div>
            <div class="footer-section">
                <h4>Developer's Contact</h4>
                <p><i class="fas fa-phone"></i> 09217728538</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 File Storage Tracker. All rights reserved.</p>
        </div>
    </div>
</footer>




<div id="modal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeModal()">
            <i class="fas fa-times"></i>
        </button>
        <h2>Sign In</h2>
        <div class="modal-form">
            <div class="form-group">
                <input id="login-user" placeholder="Username" />
            </div>
            <div class="form-group">
                <input id="login-pass" type="password" placeholder="Password" />
            </div>
            <div class="modal-buttons">
                <button id="cancel-login" class="btn btn-secondary">Cancel</button>
                <button id="submit-login" class="btn btn-primary">Sign In</button>
            </div>
        </div>
    </div>
</div>

<div id="change-account-modal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeChangeModal()">
            <i class="fas fa-times"></i>
        </button>
        <h2>Change Account</h2>
        <div class="modal-form">
            <div class="form-group">
                <input id="change-user" placeholder="New Username" />
            </div>
            <div class="form-group">
                <input id="change-pass" type="password" placeholder="New Password" />
            </div>
            <div class="form-group">
                <input id="change-pass-confirm" type="password" placeholder="Confirm New Password" />
            </div>
            <div class="modal-buttons">
                <button id="cancel-change" class="btn btn-secondary">Cancel</button>
                <button id="submit-change" class="btn btn-primary">Update</button>
            </div>
        </div>
    </div>
</div>

<div id="password-verify-modal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeVerifyModal()">
            <i class="fas fa-times"></i>
        </button>
        <h2 id="verify-modal-title">Verify Password</h2>
        <div class="modal-form">
            <div class="form-group">
                <input id="verify-password" type="password" placeholder="Enter your password" />
            </div>
            <div class="modal-buttons">
                <button id="cancel-verify" class="btn btn-secondary" onclick="cancelVerify()">Cancel</button>
                <button id="submit-verify" class="btn btn-primary" onclick="proceedWithAction(document.getElementById('verify-password').value)">Confirm</button>
            </div>
        </div>
    </div>
</div>

<div id="edit-file-modal" class="modal">
    <div class="modal-content">
        <button class="modal-close" onclick="closeEditModal()">
            <i class="fas fa-times"></i>
        </button>
        <h2>Edit File Details</h2>
        <div class="modal-form">
            <div class="form-group">
                <label>Title</label>
                <input id="edit-title" type="text" placeholder="File title" />
            </div>
            <div class="form-group">
                <label>Location</label>
                <input id="edit-storage" type="text" placeholder="Storage location" />
            </div>
            <div class="form-group">
                <label>Info (Optional)</label>
                <input id="edit-info" type="text" placeholder="Additional information" />
            </div>
            <div class="modal-buttons">
                <button id="cancel-edit" class="btn btn-secondary">Cancel</button>
                <button id="submit-edit" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Image Viewer Modal for zoomed image viewing -->
<div id="image-viewer-modal" class="modal">
    <div class="image-viewer-content">
        <button class="modal-close" onclick="closeImageViewer()">
            <i class="fas fa-times"></i>
        </button>
        <img id="viewer-image" src="" alt="Image viewer">
    </div>
</div>

<div id="success-notification" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 400px; text-align: center; border-radius: 12px;">
        <div style="font-size: 48px; color: #4CAF50; margin-bottom: 20px;">
            <i class="fas fa-check-circle"></i>
        </div>
        <h2 style="color: #4CAF50; margin-bottom: 15px;">Success!</h2>
        <div id="success-message" style="color: #555; margin-bottom: 25px; line-height: 1.6;"></div>
        <button class="btn btn-primary" onclick="closeSuccessNotification()" style="width: 100%;">Close</button>
    </div>
</div>

    <!-- Logo Popup Animation Script -->
    <script>
        // Logo Popup Animation on Page Load
        document.addEventListener('DOMContentLoaded', function() {
            // Show popup on page load
            showLogoPopup();
        });

        /**
         * Display the logo popup with animation
         */
        function showLogoPopup() {
            const popup = document.getElementById('logoPopup');
            const body = document.body;

            // Show popup and disable scrolling
            popup.style.display = 'flex';
            body.classList.add('popup-active');

            // Auto-hide popup after 2.5 seconds
            setTimeout(() => {
                hideLogoPopup();
            }, 2500);
        }

        /**
         * Hide the logo popup with fade-out animation
         */
        function hideLogoPopup() {
            const popup = document.getElementById('logoPopup');
            const body = document.body;

            // Create fade-out animation
            popup.style.animation = 'popupFadeOut 0.5s ease-in-out forwards';

            // Remove popup after animation completes
            setTimeout(() => {
                popup.style.display = 'none';
                popup.style.animation = ''; // Reset animation
                body.classList.remove('popup-active'); // Re-enable scrolling
            }, 500);
        }

        /**
         * Close the image viewer modal
         */
        function closeImageViewer() {
            const modal = document.getElementById('image-viewer-modal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        /**
         * Open the image viewer modal with the clicked image
         */
        function openImageViewer(imageSrc) {
            const modal = document.getElementById('image-viewer-modal');
            const viewerImage = document.getElementById('viewer-image');
            if (modal && viewerImage) {
                viewerImage.src = imageSrc;
                modal.style.display = 'flex';
            }
        }

        /**
         * Handle image file upload
         */
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    // Store the image data in the window object for later use
                    window.uploadedImageData = e.target.result;
                    // You can also display a preview
                    console.log('Image uploaded and ready for storing with file data');
                };
                reader.readAsDataURL(file);
            }
        }

        // Add event listener for image upload input
        document.addEventListener('DOMContentLoaded', function() {
            const imageUploadInput = document.getElementById('imageUpload');
            if (imageUploadInput) {
                imageUploadInput.addEventListener('change', handleImageUpload);
            }

            // Init nav visibility and UI bindings
            updateNavVisibility();

            // Sort toggle and change
            const sortToggle = document.getElementById('sort-toggle-btn');
            const sortSelect = document.getElementById('sort-select');
            if (sortToggle && sortSelect) {
                sortToggle.addEventListener('click', () => {
                    // toggle display of the select
                    sortSelect.style.display = (sortSelect.style.display === 'block') ? 'none' : 'block';
                });
                sortSelect.addEventListener('change', () => {
                    sortResults(document.getElementById('results-main'), sortSelect.value);
                });

                // Re-apply sort automatically when results change
                const resultsMain = document.getElementById('results-main');
                if (resultsMain) {
                    const observer = new MutationObserver(() => {
                        if (!sortSelect.value) return;
                        // Disconnect temporarily to avoid recursive callbacks when sortResults mutates the DOM
                        try {
                            observer.disconnect();
                            sortResults(resultsMain, sortSelect.value);
                        } catch (e) {
                            console.error('Observer sort error:', e);
                        } finally {
                            observer.observe(resultsMain, { childList: true, subtree: false });
                        }
                    });
                    observer.observe(resultsMain, { childList: true, subtree: false });
                }
            }

            // Native date input bindings for date picker
            const openDateBtn = document.getElementById('open-date-picker');
            const nativeDate = document.getElementById('native-date-input');
            const titleInput = document.getElementById('title');
            if (openDateBtn && nativeDate && titleInput) {
                openDateBtn.addEventListener('click', () => nativeDate.showPicker ? nativeDate.showPicker() : nativeDate.click());
                nativeDate.addEventListener('change', () => {
                    if (!nativeDate.value) return;
                    // format to a human readable string
                    const d = new Date(nativeDate.value);
                    if (isNaN(d)) return;
                    titleInput.value = formatDateForDisplay(d);
                });
            }

            // Also update nav visibility on hash changes
            window.addEventListener('hashchange', updateNavVisibility);
        });

        // Hide the Features nav link when dashboard is active
        function updateNavVisibility() {
            const featuresLink = document.getElementById('nav-features');
            if (!featuresLink) return;
            const isDashboard = (location.hash === '#dashboard' || document.querySelector('.dashboard-section')?.classList.contains('active') || document.getElementById('results-main')?.parentElement?.style.display !== 'none' && location.hash === '#dashboard');
            featuresLink.style.display = isDashboard ? 'none' : '';
        }

        // Format date as: January 2, 2000
        function formatDateForDisplay(date) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return date.toLocaleDateString(undefined, options);
        }

        // Try to parse many date formats; default to interpreting '01-02-2000' as MM-DD-YYYY when ambiguous
        function parseDateString(s) {
            if (!s || typeof s !== 'string') return null;
            s = s.trim();
            // ISO YYYY-MM-DD
            let m = s.match(/^(\d{4})[-\/\.](\d{1,2})[-\/\.](\d{1,2})$/);
            if (m) {
                return new Date(parseInt(m[1],10), parseInt(m[2],10)-1, parseInt(m[3],10));
            }
            // MM-DD-YYYY or MM/DD/YYYY or MM.DD.YYYY
            m = s.match(/^(\d{1,2})[-\/\.](\d{1,2})[-\/\.](\d{4})$/);
            if (m) {
                const mm = parseInt(m[1],10), dd = parseInt(m[2],10), yy = parseInt(m[3],10);
                // interpret first number as month if <=12
                if (mm >=1 && mm <=12) return new Date(yy, mm-1, dd);
                // otherwise treat as day-month-year
                return new Date(yy, dd-1, mm);
            }
            // textual month like 'January 2, 2000'
            m = s.match(/^([A-Za-z]+)\s+(\d{1,2}),?\s+(\d{4})$/);
            if (m) {
                const mn = monthNameToNumber(m[1]);
                if (mn) return new Date(parseInt(m[3],10), mn-1, parseInt(m[2],10));
            }
            // fallback: try Date constructor
            const d = new Date(s);
            if (!isNaN(d)) return d;
            return null;
        }

        function monthNameToNumber(name) {
            const map = { jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12 };
            if(!name) return null;
            const short = name.toString().toLowerCase().slice(0,3);
            return map[short] || null;
        }

        // Find a date inside an element by checking data-date, .file-date, or text content
        function findDateInElement(el) {
            if (!el) return null;
            // data-date attribute
            if (el.dataset && el.dataset.date) {
                return parseDateString(el.dataset.date);
            }
            // element with class file-date
            const dateEl = el.querySelector && el.querySelector('.file-date');
            if (dateEl && dateEl.textContent) {
                return parseDateString(dateEl.textContent);
            }
            // search for date-like substrings in the text
            const txt = el.textContent || '';
            const regexes = [
                /(\d{1,2}[-\/\.]\d{1,2}[-\/\.]\d{4})/, // 01-02-2000
                /(\d{4}[-\/\.]\d{1,2}[-\/\.]\d{1,2})/, // 2000-01-02
                /([A-Za-z]+ \d{1,2},? \d{4})/ // January 2, 2000
            ];
            for (const r of regexes) {
                const m = txt.match(r);
                if (m) {
                    const d = parseDateString(m[1]);
                    if (d) return d;
                }
            }
            return null;
        }

        // Sort results in a container element. mode is one of the values in the select.
        function sortResults(container, mode = 'date-asc') {
            if (!container) return;
            const items = Array.from(container.children);
            // attach parsed date and fallback timestamp; unknown dates go to the end for asc and to the start for desc
            const annotated = items.map(el => {
                const d = findDateInElement(el);
                const timestamp = d ? d.getTime() : (mode && mode.endsWith('-desc') ? -Infinity : Infinity);
                const month = d ? (d.getMonth()+1) : 0;
                const year = d ? d.getFullYear() : 0;
                return {el, d, timestamp, month, year};
            });

            if (mode === 'month-year-asc' || mode === 'month-year-desc') {
                annotated.sort((a,b) => {
                    if (a.month === b.month) {
                        if (a.year === b.year) return a.timestamp - b.timestamp;
                        return (mode==='month-year-asc') ? (a.year - b.year) : (b.year - a.year);
                    }
                    return a.month - b.month;
                });
            } else if (mode === 'date-asc') {
                annotated.sort((a,b) => a.timestamp - b.timestamp);
            } else { // date-desc
                annotated.sort((a,b) => b.timestamp - a.timestamp);
            }

            // Append in new order
            annotated.forEach(it => container.appendChild(it.el));

            // Provide a brief status
            const status = document.getElementById('statusMessage');
            if (status) {
                status.textContent = 'Results sorted (' + (mode || 'month-year-asc') + ')';
                setTimeout(() => { status.textContent = ''; }, 2500);
            }
        }
    </script>



    <script src="script.js"></script>

</body>
</html>
        <script src="script.js"></script>

        <script>
        // Workers UI: add/select/delete workers and persist selection to localStorage
        document.addEventListener('DOMContentLoaded', function(){
            const workersKey = 'workers_v1';
            const selectedKey = 'selectedWorker';
            const workersListEl = document.getElementById('workersList');
            const workerInput = document.getElementById('workerNameInput');
            const addBtn = document.getElementById('addWorkerBtn');
            const currentUserDisplay = document.getElementById('currentUserDisplay');

            if (!workersListEl || !addBtn) return;

            let workers = JSON.parse(localStorage.getItem(workersKey) || '[]');
            let selected = localStorage.getItem(selectedKey) || null;

            function save() { localStorage.setItem(workersKey, JSON.stringify(workers)); }
            function saveSelected() { if (selected) localStorage.setItem(selectedKey, selected); else localStorage.removeItem(selectedKey); }

            function render() {
                workersListEl.innerHTML = '';
                workers.forEach((w, idx) => {
                    const li = document.createElement('li');
                    li.style.display = 'flex'; li.style.gap = '6px'; li.style.alignItems = 'center'; li.style.margin = '6px 0';
                    if (w === selected) li.style.background = '#e0f3ff';
                    const span = document.createElement('div'); span.className = 'name'; span.textContent = w; span.style.flex = '1';
                    const selBtn = document.createElement('button'); selBtn.textContent = (w===selected)?'Selected':'Select'; selBtn.style.padding='4px 8px'; selBtn.onclick = ()=>{ selected = (w===selected)? null : w; saveSelected(); render(); };
                    const delBtn = document.createElement('button'); delBtn.textContent = 'X'; delBtn.style.background='#ffe6e6'; delBtn.style.padding='4px 8px'; delBtn.onclick = ()=>{ if (confirm('Remove '+w+'?')){ workers.splice(idx,1); if (selected===w) selected=null; save(); saveSelected(); render(); } };
                    li.appendChild(span); li.appendChild(selBtn); li.appendChild(delBtn);
                    workersListEl.appendChild(li);
                });
                currentUserDisplay.textContent = selected || 'None';
            }

            addBtn.addEventListener('click', ()=>{
                const v = (workerInput.value||'').trim();
                if (!v) return;
                if (workers.includes(v)){ alert('Name already exists'); workerInput.value=''; return; }
                workers.push(v); workerInput.value=''; save(); render();
            });
            workerInput.addEventListener('keydown', (e)=>{ if (e.key==='Enter') addBtn.click(); });

            render();
        });

        // Show/hide workers box and reminder based on active section
        document.addEventListener('DOMContentLoaded', function(){
            function updateVisibility() {
                const isHero = document.querySelector('.hero-section.active') !== null;
                if (isHero) {
                    document.body.classList.add('on-hero');
                } else {
                    document.body.classList.remove('on-hero');
                }
            }
            updateVisibility();
            // Listen for section changes
            const observer = new MutationObserver(updateVisibility);
            document.querySelectorAll('.view-section').forEach(section => {
                observer.observe(section, { attributes: true, attributeFilter: ['class'] });
            });
        });
        </script>

        <script>
        // Sync workers/reminder background to match navbar when in dark mode,
        // otherwise use a translucent white so the hero background shows through.
        (function(){
            function syncBackgrounds(){
                const workers = document.querySelector('.workers-box');
                const reminder = document.querySelector('.reminder');
                const navbar = document.querySelector('header.navbar');
                if (!workers || !reminder || !navbar) return;
                const isDark = document.documentElement.classList.contains('dark-mode');
                if (isDark) {
                    // use computed navbar background as the workers/reminder background
                    const navStyle = getComputedStyle(navbar);
                    const bg = navStyle.backgroundColor || 'rgba(30,30,30,0.95)';
                    workers.style.background = bg;
                    workers.style.borderColor = navStyle.borderColor || 'rgba(0,0,0,0.3)';
                    reminder.style.background = bg;
                    reminder.style.borderColor = navStyle.borderColor || 'rgba(0,0,0,0.3)';
                } else {
                    // translucent white to show hero background
                    workers.style.background = 'rgba(255,255,255,0.92)';
                    workers.style.borderColor = '#ddd';
                    reminder.style.background = 'rgba(255,250,200,0.95)';
                    reminder.style.borderColor = '#f0e68c';
                }
            }

            // Run on load
            document.addEventListener('DOMContentLoaded', syncBackgrounds);

            // Observe html class changes (for dark-mode toggle)
            const docEl = document.documentElement;
            const obs = new MutationObserver(syncBackgrounds);
            obs.observe(docEl, { attributes: true, attributeFilter: ['class'] });
        })();
        </script>





